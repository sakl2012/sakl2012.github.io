!function(){"use strict";document.querySelectorAll(".back-to-top, .lnk").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();let n=e.getAttribute("href").substring(1),l=0;n&&(l=window.scrollY+document.getElementById(n).getBoundingClientRect().top-document.getElementById("includeNavbar").offsetHeight+20),function e(t,n){let l=window.scrollY||document.documentElement.scrollTop,o;window.requestAnimationFrame(function e(n){var s;o||(o=n);let a=Math.min((n-o)/400,1);window.scrollTo(0,l+(t-l)*((s=a)*(2-s))),a<1&&window.requestAnimationFrame(e)})}(l,400)})}),window.addEventListener("scroll",()=>{document.querySelectorAll(".back-to-top, .lnk").forEach(e=>{e.style.display=window.scrollY>50?"block":"none"})});let e="googleSheetsData",t={includeSidebar:"HTML!A2",includeNavbar:"HTML!B2",info:"HTML!E2",about:"HTML!D2",publications:"HTML!C2"},n=e=>{Object.keys(t).forEach((t,n)=>{let l=document.getElementById(t);l&&(l.innerHTML=e.valueRanges[n]&&e.valueRanges[n].values&&e.valueRanges[n].values.length>0?e.valueRanges[n].values[0][0]:"Content not found.")})},l=()=>{let l=localStorage.getItem(e),o=localStorage.getItem(`${e}_timestamp`);if(l&&o&&Date.now()-parseInt(o,10)<36e5){console.log("載入自快取..."),n(JSON.parse(l));return}console.log("從網路獲取新資料..."),fetch(`https://sheets.googleapis.com/v4/spreadsheets/1EsbqSfOS97txN7_nwxpujdkV3g6scHB24TSAaJ25AMo/values:batchGet?ranges=${Object.values(t).join("&ranges=")}&key=AIzaSyD8sJOgRFmGvQ6T5X-PjwVfpEsb8pG2y2o`).then(e=>{if(!e.ok)throw Error("網路響應不佳或 API 金鑰無效");return e.json()}).then(t=>{localStorage.setItem(e,JSON.stringify(t)),localStorage.setItem(`${e}_timestamp`,Date.now().toString()),n(t)}).catch(e=>{console.error("從 Google Sheets 獲取資料時發生錯誤：",e),Object.keys(t).forEach(e=>{let t=document.getElementById(e);t&&(t.innerHTML="無法載入內容。請稍後再試。")})})};document.addEventListener("DOMContentLoaded",l)}();